@startuml "LangGraph-Deployment-Flow"
' Diagram zobrazuj√≠c√≠ workflow nasazen√≠ AI-agent-Ntier do LangGraph Platform

!theme plain
skinparam backgroundColor #FEFEFE
skinparam TitleFontSize 20
skinparam ActivityBackgroundColor #f0f8ff
skinparam ActivityBorderColor #87CEFA
skinparam ArrowColor #333333

title "Workflow nasazen√≠ AI-agent-Ntier do LangGraph Platform"

start
:Identifikace a anal√Ωza probl√©mu\ns JSON sch√©maty v LangGraph;
note right: Chyba: "Cannot generate a JsonSchema\nfor core_schema.IsInstanceSchema\n(<class 'memory_agent.tools.MockMCPConnector'>)"

:Vytvo≈ôen√≠ schema.py\ns Pydantic modely;
note right: MockMCPConnectorConfig\nCompanyData\nPersonData\nRelationshipData

:√öprava State t≈ô√≠dy;
note right: Zmƒõna atributu z:\nmcp_connector: Optional[MockMCPConnector]\nna:\nmcp_connector_config: Optional[MockMCPConnectorConfig]

:Implementace get_mcp_connector()\nmetody v State t≈ô√≠dƒõ;
note right: Vytv√°≈ô√≠ instanci konektoru\nz konfigurace, kter√° je\nserializovateln√°

:P≈ôid√°n√≠ create_mcp_connector_from_config()\ndo utils.py;
note right: Pom√°h√° vytv√°≈ôet instance\nz konfigurac√≠

:√öprava analyzer.py\npro synchronn√≠ operace;
note right: Pro kompatibilitu\ns grafov√Ωmi uzly

:Aktualizace graph_nodes.py\npro spr√°vnou klasifikaci dotaz≈Ø;
note right: Spr√°vn√© zpracov√°n√≠\nAnalysisResult v√Ωstupu

:Vytvo≈ôen√≠ a spu≈°tƒõn√≠ test≈Ø;

if (Funguje testov√°n√≠?) then (ano)
  :Vytvo≈ôen√≠ nov√© vƒõtve v Git;
  note right: git checkout -b langraph-schema-fix
  
  :Commit zmƒõn;
  note right: git commit -m "Fix JSON schema generation\nfor LangGraph Platform"
  
  :Push do GitHub;
  note right: git push origin langraph-schema-fix
  
  :Sestaven√≠ projektu pro LangGraph Platform;
  note right: langgraph build --tag ai-agent-ntier:latest
  
  :Nasazen√≠ na LangGraph Platform;
  note right: langgraph up
  
  :Verifikace v produkci;
  note right: Kontrola log≈Ø a\ntestov√°n√≠ konverzace
  
  if (Funguje v produkci?) then (ano)
    :Slouƒçen√≠ vƒõtve do main;
    note right: git checkout main\ngit merge langraph-schema-fix
    
    :Dokumentace ≈ôe≈°en√≠;
    note right: Aktualizace deploy_logs/notes.md
    
    :√öspƒõ≈°n√Ω deployment! üéâ;
  else (ne)
    :Identifikace probl√©m≈Ø;
    :Dal≈°√≠ iterace oprav;
  endif
else (ne)
  :Anal√Ωza chyb v testech;
  :√öprava implementace;
  note left: Oprava probl√©m≈Ø\nv k√≥du
endif

stop
@enduml
